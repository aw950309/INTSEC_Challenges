Challenge 4.1 (Simple):
Fictional scenario: Imagine I wrote a game for the student of the course.
I put it on a linux server where all students have an account and are part of the group students.
Here are the files related to the game:
- _ _ _ _ _ _ _ _ _ nicolas students game-binary
- _ _ _ _ _ _ _ _ _ nicolas students high-scores.txt

Set the rights to let anyone in the group "students" play the game and save their best score, without allowing anyone to cheat.

(Apply the principle of least privilege and Fail-safe defaults)."

 You can assume that a process regularly saves and flushes the content of high-scores.txt. (Credit for this problem: Alan Davidson.)
Based on the security principles and mechanisms described in Computer Security: Art and Science, here is the solution to the challenge.

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


Solution points to consider:
Principle of Least Privilege: Subjects should only be granted the specific permissions necessary to complete their task, and nothing more.
Principle of Fail-Safe Defaults: Access decisions should be based on permissions rather than exclusions; the default state for any subject should be "access denied."

I assume:
The game binary is designed to handle file I/O operations securely (e.g., locking the file while writing)
The owner nicolas is the trusted administrator of the game.
And of course that the process regulary saves and flushes the content of high-scores.txt.

The goal:
Allow members of  "students" to execute the game and for the game to update the high-scores.txt file.
Users must not be able to modify the text file directly outside of the game environment.

Issue: "students" need to write their score to high-scores.txt. but giving them "Write" (w) permission on the text file makes it so they can open it in a text editor and cheat by changing the score.
I think using SetUID (page 1007 in book) is the best solution here. EDIT: After reading further, I think using SetGID is better. Smaller attack surface.

 Solution:

SetUID would give full owner permissions, while SetGID would give custom group permissions only. SetGID would create a new group like "games" with read/write access, but "students" would only have read access to the text file.

But "students" could still run the game binary, which has SetGID set, and the game binary would have group "games" with write access to the text file.

By setting the SetGID bit (s) on the executable, the operating system executes the program with the effective Group ID of the file Istead of the studentâ€™s default group.

When the game runs, the process therefore acts with the group privileges of "games"". Since "games"  have write access to high-scores.txt, the game can update the score file.

If a student tries to edit high-scores.txt directly via the shell or a text editor, they are acting as a normal user process without elevated group privileges, and are denied write access.

Apply principle of least privilege:
"Students" are given Execute (x) permissions on the binary (via "other" permissions) so they can run it. They lack direct Write (w) access to the text file to prevent cheating.
The SetGID bit runs the process with the Group's identity ("games') during execution. This grants the specific privilege required to write to high-scores.txt without granting the full privileges of the user nicolas (which SetUID would do).
This minimizes the privileges the process holds.

Apply principle of fail-safe defaults:
We should  deny all access to all users who are not Nicolas or "students".
If a user does not have explicit permission, they cannot see or run these files.
Furthermore, by default, the group is denied write access to the data file; this ensures that if the binary fails or permissions are misconfigured, the system defaults to a state where the data cannot be corrupted.

Commands to set the permissions:
sudo groupadd games
sudo chown nicolas:games game-binary
chmod 0660 high-scores.txt
chmod 2751 game-binary

- r w x r - s - - x nicolas games game-binary

- r w - r w - - - - nicolas games high-scores.txt
